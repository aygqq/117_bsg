# Changelog

## [5] - 2021-11-16
### Added
- Генерация тестового пакета для документации
- Разрывы TCP соединений после отправки пачки пакетов
- Отправка раз в 15 секунд, если есть больше 256 байт данных.
- Синхронизация времени через GPS
- Добавлен парсинг новых данных GPS
- Добавлен запрос IMEI, пока он только выводится в консоль.
- Счетчики времени для оценки работы с сессиями
- Новый тип данных для GPS и для дверей
- Короткий формат геоданных для ИУ
### Changed
- Приём GPS переделан через idle прерывания
- Частота отправки GPS зависит от скорости
- Задача GPS теперь работает по состояниям
### Removed

## [3] - 2021-11-09
### Added
- Контроль синхронизации времени между ИУ и БСГ.
### Changed
- Опрос ИУ переделан через диаграму состояний.
- Соотнесены коды телеметрии с проектом ИУ.
- Мьютекс RTC теперь работает и на запись время.
- Минимальное число страниц для отправки уменьшено с 3 до 2.
- Исправлена телеметрия при перепрошивке ИУ.
- Отправка координат на сервер раз в 2 секунды, если скорость больше 5 км/ч.
- Отправка координат на ИУ чаще в 5 раз (20-30 сек).
### Removed

## [1] - 2021-10-14
- Первая версия БСГ проекта 127
- Есть документ со всеми типами и кодами данных для сервера
### Added
- Задача опроса ИУ
- Статистика модема, страниц памяти, ошибок в уартах (см документ)
- Телеметрия, связанная с ИУ
- Разделение отправки данных от своего UID и от UID ИУ
- Загрузка и передача новой прошивки на ИУ
- Проверка на принадлежность номера прошивки БСГ или ИУ к определенным диапазонам
- Подсчет общей контрольной суммы новой прошивки и запись ее в память
- Проверка бутом этой контрольной суммы и длины прошивки (20-200 КБ)
- Переход на крутое логгирование
- Работа с spiflash взята из БКТЭ_117
- Карта битых секторов spiflash, сохранение карты происходит один раз за полный круг по памяти.

### Changed
- Под загрузчик теперь выделено 2 сектора (8 КБ), 3й сектор под служебные данные
- GPS отправляем раз в 2 минуты
- Уменьшено время ожидания отправки TCP пакета с 90 до 40 сек.

### Removed